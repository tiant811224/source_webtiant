---
title: "【规约】 C++ 编程篇"
date: 2021-05-28T11:46:44+08:00

categories: [
    "编程规范",
]
---
### 前言

“码出高效，码出质量”。本文整理了比较常见的 C++ 编程规范，主要来源于华为《软件编程规范总则》。

### （一）排版
1.程序块要采用缩进风格编写，缩进的空格数位 4 个。对齐只用空格键，不适用tab键。  
2.相对独立的程序块之间、变量说明之后必须加空行。  
3.较长的语句（>80 字符）要分成多行书写，长表达式要在低优先级操作符划分新行，操作符放在新行之首。  
4.if、for、do、while、case、switch、default 等语句自占一行，且执行语句部分无论多少都要加括号 {}。  

### （二）注释
1.一般情况下，源程序有效注释量必须在 20% 以上。  
2.说明性文件（如头文件 .h 文件、.inc 文件、.def 文件等）头部应进行注释，注释必须列出：版权说明、版本号、生成日期、作者、内容、功能、与其他头文件关系、修改日志等，头文件注释中还应有函数功能简要说明。  
3.源文件头部应进行注释，列出：版权说明、版本号、生成日期、作者、模块目的/功能、主要函数及其功能、修改日志等。  
4.函数头部应进行注释，列出：函数的目的/功能、输入参数、输出参数、返回值、调用关系（函数、表）等。  
5.边写代码边注释，修改代码同时修改响应的注释。不再有用的注释 要删除。  
6.注释格式尽量统一，建议使用“/*…………*/”。  
7.注释应考虑程序易读性，建议使用中文。

### （三）标识符命名
1.命名规范必须与所使用的系统风格保持一致，并在同一项目中统一，比如采用 UNIX 的全小写加下划线风格或大小写混排的方式，不要将两种方式混合使用。用作特殊标识如标识成员变量或全局变量的 m_ 和 g_，其后加上大小写混排的方式是允许的。  
    示例：Add_User 不允许，add_user、AddUser、m_AddUser允许。

2.用正确的反义词组命名具有互斥意义的变量或相反动作的函数等。  
    说明：以下是一些在软件中常用的反义词组。  
    add / remove    begin / end    create / destroy  
    insert /delete    first / last    get / release  
    increment / decrement    put / get  
    add /delete    lock unlock    open /close  
    min / max    old /new     stat / stop  
    next /previous    source / target    show / hide  
    send / receive    source / destination    
    cut /paste    up / down  
    示例：  
    int min_sum;  
    int max_sum;  
    int add_user( BYTE *user_name );  
    int delete_user( BYTE *user_name);  

### （四）可测性
1.使用断言来发现软件问题，提高代码可测性。

### （五）程序效率
1.多重循环中，应将最忙的循环放在最内层。  
2.尽量减少循环嵌套层次。  
3.尽量使用乘法或其他方法代替除法特别是浮点运算中的除法（占用较多 CPU 资源）。  

### （六）质量保证
1.防止引用已经释放的内存空间。  
2.过程/函数中分配的内存，在过程/函数退出之前要释放。  
3.过程/函数中申请的（为打开文件而使用的）文件句柄，在过程/函数退出之前要关闭。  
4.防止内存操作越界。  
5.编程时，要防止差 1 错误。（<=、<等注意）  
6.if 语句尽量加上 else 分支，switch 语句必须有 default 分支。  
7.Unix 下，多线程的子线程退出必需采用主动退出的方式，即子线程应 return 出口。  
8.时刻注意表达式是否会上溢、下溢。使用变量时要注意其边界值的情况。  

